
            <!DOCTYPE html>
            <html lang="zh-CN">
                <head>
                    <meta charset="UTF-8">
                    <title>
 live555学习笔记－RTP打包与发送 - CSDN博客
</title>

                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-60a2c245da.min.css">
                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-88717cedf2.min.css">

                <script type="text/javascript">
                var username = "";
                </script>

                <script src="https://csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script>

                <!-- 新版上报 -->
                <!-- 新版上报end -->
                <link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.3/css/sandalstrap.min.css"> 
                </head>
                <body>    
        
                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
                    <div class="container clearfix pt0" id="mainBox">
        <main style="width: 100%;"><div class="blog-content-box">
 <div class="article-title-box" id="article_anchors_514">
  <span class="article-type type-2 float-left">
   转
  </span>
  <h1 class="title-article">
   live555学习笔记－RTP打包与发送
  </h1>
 </div>
 <div class="article-info-box">
  <div class="article-bar-top d-flex">
   <span class="time">
    2013年09月20日 17:16:58
   </span>
   <div ">
    <span class="read-count">
     阅读数：8527
    </span>
   </div>
  </div>
 </div>
 <article>
  <div class="article_content clearfix csdn-tracking-statistics" data-dsm="post" data-mod="popu_307" data-pid="blog" id="article_content">
   <link href="https://csdnimg.cn/release/phoenix/template/css/htmledit_views-0a60691e80.css" rel="stylesheet"/>
   <div class="htmledit_views">
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     RTP打包与发送
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <br/>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     rtp传送开始于函数：MediaSink::startPlaying()。想想也有道理，应是sink跟source要数据，所以从sink上调用startplaying（嘿嘿，相当于directshow的拉模式）。
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <br/>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     看一下这个函数：
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:625px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         Boolean MediaSink::startPlaying(MediaSource&amp; source,
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        afterPlayingFunc* afterFunc,
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         * afterClientData)
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //参数afterFunc是在播放结束时才被调用。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Make sure we're not already being played:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fSource != NULL) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        envir().setResultMsg(
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         "This sink is already being played"
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         );
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         return
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         False;
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Make sure our source is compatible:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (!sourceIsCompatibleWithUs(source)) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        envir().setResultMsg(
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         "MediaSink::startPlaying(): source is not compatible!"
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         );
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         return
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         False;
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //记下一些要使用的对象
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fSource = (FramedSource*) &amp;source;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fAfterFunc = afterFunc;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fAfterClientData = afterClientData;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         return
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         continuePlaying();
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     为了进一步封装（让继承类少写一些代码），搞出了一个虚函数continuePlaying()。让我们来看一下：
    </p>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:1170px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         Boolean MultiFramedRTPSink::continuePlaying() {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Send the first packet.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (This will also schedule any future sends.)
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        buildAndSendPacket(True);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         return
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         True;
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     MultiFramedRTPSink是与帧有关的类，其实它要求每次必须从source获得一个帧的数据，所以才叫这个name。可以看到continuePlaying()完全被buildAndSendPacket()代替。看一下buildAndSendPacket():
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:1399px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         MultiFramedRTPSink::buildAndSendPacket(Boolean isFirstPacket)
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //此函数中主要是准备rtp包的头，为一些需要跟据实际数据改变的字段留出位置。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fIsFirstPacket = isFirstPacket;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Set up the RTP header:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned rtpHdr = 0x80000000;
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // RTP version 2; marker ('M') bit not set (by default; it can be set later)
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        rtpHdr |= (fRTPPayloadType &lt;&lt; 16);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        rtpHdr |= fSeqNo;
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // sequence number
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;enqueueWord(rtpHdr);
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //向包中加入一个字
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Note where the RTP timestamp will go.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (We can't fill this in until we start packing payload frames.)
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fTimestampPosition = fOutBuf-&gt;curPacketSize();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;skipBytes(4);
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // leave a hole for the timestamp　在缓冲中空出时间戳的位置
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;enqueueWord(SSRC());
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Allow for a special, payload-format-specific header following the
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // RTP header:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fSpecialHeaderPosition = fOutBuf-&gt;curPacketSize();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fSpecialHeaderSize = specialHeaderSize();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;skipBytes(fSpecialHeaderSize);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Begin packing as many (complete) frames into the packet as we can:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fTotalFrameSpecificHeaderSizes = 0;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNoFramesLeft = False;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNumFramesUsedSoFar = 0;
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // 一个包中已打入的帧数。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //头准备好了，再打包帧数据
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        packFrame();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     继续看packFrame()：
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:2159px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         MultiFramedRTPSink::packFrame()
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // First, see if we have an overflow frame that was too big for the last pkt
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fOutBuf-&gt;haveOverflowData()) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果有帧数据，则使用之。OverflowData是指上次打包时剩下的帧数据，因为一个包可能容纳不了一个帧。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Use this frame before reading a new one from the source
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned frameSize = fOutBuf-&gt;overflowDataSize();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         struct
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         timeval presentationTime = fOutBuf-&gt;overflowPresentationTime();
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned durationInMicroseconds =fOutBuf-&gt;overflowDurationInMicroseconds();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;useOverflowData();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        afterGettingFrame1(frameSize, 0, presentationTime,durationInMicroseconds);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //一点帧数据都没有，跟source要吧。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Normal case: we need to read a new frame from the source
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fSource == NULL)
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         return
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ;
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //更新缓冲中的一些位置
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fCurFrameSpecificHeaderPosition = fOutBuf-&gt;curPacketSize();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fCurFrameSpecificHeaderSize = frameSpecificHeaderSize();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;skipBytes(fCurFrameSpecificHeaderSize);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fTotalFrameSpecificHeaderSizes += fCurFrameSpecificHeaderSize;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //从source获取下一帧
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fSource-&gt;getNextFrame(fOutBuf-&gt;curPtr(),
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //新数据存放开始的位置
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;totalBytesAvailable(),
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //缓冲中空余的空间大小
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        afterGettingFrame,
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //因为可能source中的读数据函数会被放在任务调度中，所以把获取帧后应调用的函数传给source
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         this
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ,
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        ourHandleClosure,
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //这个是source结束时(比如文件读完了)要调用的函数。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         this
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         );
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     可以想像下面就是source从文件（或某个设备）中读取一帧数据，读完后返回给sink，当然不是从函数返回了，而是以调用afterGettingFrame这个回调函数的方式。所以下面看一下afterGettingFrame():
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:2964px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         MultiFramedRTPSink::afterGettingFrame(
        </span>
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         * clientData,
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned numBytesRead, unsigned numTruncatedBytes,
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         struct
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         timeval presentationTime, unsigned durationInMicroseconds)
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        MultiFramedRTPSink* sink = (MultiFramedRTPSink*) clientData;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        sink-&gt;afterGettingFrame1(numBytesRead, numTruncatedBytes, presentationTime,
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        durationInMicroseconds);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     没什么可看的，只是过度为调用成员函数，所以afterGettingFrame1()才是重点：
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:3203px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         MultiFramedRTPSink::afterGettingFrame1(
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned frameSize,
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned numTruncatedBytes,
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         struct
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         timeval presentationTime,
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned durationInMicroseconds)
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fIsFirstPacket) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Record the fact that we're starting to play now:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        gettimeofday(&amp;fNextSendTime, NULL);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果给予一帧的缓冲不够大，就会发生截断一帧数据的现象。但也只能提示一下用户
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (numTruncatedBytes &gt; 0) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         const
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         bufferSize = fOutBuf-&gt;totalBytesAvailable();
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        envir()
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         "MultiFramedRTPSink::afterGettingFrame1(): The input frame data was too large for our buffer size ("
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; bufferSize
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ").  "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; numTruncatedBytes
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         " bytes of trailing data was dropped!  Correct this by increasing \"OutPacketBuffer::maxSize\" to at least "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; OutPacketBuffer::maxSize + numTruncatedBytes
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ", *before* creating this 'RTPSink'.  (Current value is "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; OutPacketBuffer::maxSize &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ".)\n"
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ;
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned curFragmentationOffset = fCurFragmentationOffset;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned numFrameBytesToUse = frameSize;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned overflowBytes = 0;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果包只已经打入帧数据了，并且不能再向这个包中加数据了，则把新获得的帧数据保存下来。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // If we have already packed one or more frames into this packet,
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // check whether this new frame is eligible to be packed after them.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (This is independent of whether the packet has enough room for this
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // new frame; that check comes later.)
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fNumFramesUsedSoFar &gt; 0) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果包中已有了一个帧，并且不允许再打入新的帧了，则只记录下新的帧。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ((fPreviousFrameEndedFragmentation &amp;&amp; !allowOtherFramesAfterLastFragment())
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        || !frameCanAppearAfterPacketStart(fOutBuf-&gt;curPtr(), frameSize))
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Save away this frame for next time:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        numFrameBytesToUse = 0;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;setOverflowData(fOutBuf-&gt;curPacketSize(), frameSize,
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        presentationTime, durationInMicroseconds);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //表示当前打入的是否是上一个帧的最后一块数据。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fPreviousFrameEndedFragmentation = False;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //下面是计算获取的帧中有多少数据可以打到当前包中，剩下的数据就作为overflow数据保存下来。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (numFrameBytesToUse &gt; 0) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Check whether this frame overflows the packet
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fOutBuf-&gt;wouldOverflow(frameSize)) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Don't use this frame now; instead, save it as overflow data, and
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // send it in the next packet instead.  However, if the frame is too
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // big to fit in a packet by itself, then we need to fragment it (and
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // use some of it in this packet, if the payload format permits this.)
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (isTooBigForAPacket(frameSize)
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &amp;&amp; (fNumFramesUsedSoFar == 0 || allowFragmentationAfterStart())) {
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // We need to fragment this frame, and use some of it now:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        overflowBytes = computeOverflowForNewFrame(frameSize);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        numFrameBytesToUse -= overflowBytes;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fCurFragmentationOffset += numFrameBytesToUse;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // We don't use any of this frame now:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        overflowBytes = frameSize;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        numFrameBytesToUse = 0;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;setOverflowData(fOutBuf-&gt;curPacketSize() + numFrameBytesToUse,
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        overflowBytes, presentationTime, durationInMicroseconds);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fCurFragmentationOffset &gt; 0) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // This is the last fragment of a frame that was fragmented over
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // more than one packet.  Do any special handling for this case:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fCurFragmentationOffset = 0;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fPreviousFrameEndedFragmentation = True;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (numFrameBytesToUse == 0 &amp;&amp; frameSize &gt; 0) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果包中有数据并且没有新数据了，则发送之。（这种情况好像很难发生啊！）
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Send our packet now, because we have filled it up:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        sendPacketIfNecessary();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //需要向包中打入数据。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Use this frame in our outgoing packet:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned
        <span class="datatypes" style="color:#2e8b57; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         char
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         * frameStart = fOutBuf-&gt;curPtr();
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;increment(numFrameBytesToUse);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // do this now, in case "doSpecialFrameHandling()" calls "setFramePadding()" to append padding bytes
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Here's where any payload format specific processing gets done:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        doSpecialFrameHandling(curFragmentationOffset, frameStart,
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        numFrameBytesToUse, presentationTime, overflowBytes);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        ++fNumFramesUsedSoFar;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Update the time at which the next packet should be sent, based
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // on the duration of the frame that we just packed into it.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // However, if this frame has overflow data remaining, then don't
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // count its duration yet.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (overflowBytes == 0) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNextSendTime.tv_usec += durationInMicroseconds;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNextSendTime.tv_sec += fNextSendTime.tv_usec / 1000000;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNextSendTime.tv_usec %= 1000000;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果需要，就发出包，否则继续打入数据。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Send our packet now if (i) it's already at our preferred size, or
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (ii) (heuristic) another frame of the same size as the one we just
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //      read would overflow the packet, or
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (iii) it contains the last fragment of a fragmented frame, and we
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //      don't allow anything else to follow this or
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // (iv) one frame per packet is allowed:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fOutBuf-&gt;isPreferredSize()
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        || fOutBuf-&gt;wouldOverflow(numFrameBytesToUse)
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        || (fPreviousFrameEndedFragmentation
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &amp;&amp; !allowOtherFramesAfterLastFragment())
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        || !frameCanAppearAfterPacketStart(
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;curPtr() - frameSize, frameSize)) {
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // The packet is ready to be sent now
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        sendPacketIfNecessary();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // There's room for more frames; try getting another:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        packFrame();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     看一下发送数据的函数：
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:5807px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         void
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         MultiFramedRTPSink::sendPacketIfNecessary()
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //发送包
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fNumFramesUsedSoFar &gt; 0) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Send the packet:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="preprocessor" style="color:gray; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         #ifdef TEST_LOSS
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ((our_random()%10) != 0)
        </span>
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // simulate 10% packet loss #####
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="preprocessor" style="color:gray; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         #endif
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (!fRTPInterface.sendPacket(fOutBuf-&gt;packet(),fOutBuf-&gt;curPacketSize())) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // if failure handler has been specified, call it
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fOnSendErrorFunc != NULL)
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        (*fOnSendErrorFunc)(fOnSendErrorData);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        ++fPacketCount;
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fTotalOctetCount += fOutBuf-&gt;curPacketSize();
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOctetCount += fOutBuf-&gt;curPacketSize() - rtpHeaderSize
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        - fSpecialHeaderSize - fTotalFrameSpecificHeaderSizes;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        ++fSeqNo;
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // for next time
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果还有剩余数据，则调整缓冲区
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fOutBuf-&gt;haveOverflowData()
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &amp;&amp; fOutBuf-&gt;totalBytesAvailable() &gt; fOutBuf-&gt;totalBufferSize() / 2) {
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Efficiency hack: Reset the packet start pointer to just in front of
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // the overflow data (allowing for the RTP header and special headers),
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // so that we probably don't have to "memmove()" the overflow data
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // into place when building the next packet:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned newPacketStart = fOutBuf-&gt;curPacketSize()-
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        (rtpHeaderSize + fSpecialHeaderSize + frameSpecificHeaderSize());
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;adjustPacketStart(newPacketStart);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Normal case: Reset the packet start pointer back to the start:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;resetPacketStart();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fOutBuf-&gt;resetOffset();
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        fNumFramesUsedSoFar = 0;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (fNoFramesLeft) {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果再没有数据了，则结束之
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // We're done:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        onSourceClosure(
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         this
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         );
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         else
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         {
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         //如果还有数据，则在下一次需要发送的时间再次打包发送。
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // We have more frames left to send.  Figure out when the next frame
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // is due to start playing, then make sure that we wait this long before
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // sending the next packet.
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         struct
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         timeval timeNow;
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        gettimeofday(&amp;timeNow, NULL);
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="datatypes" style="color:#2e8b57; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         int
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         secsDiff = fNextSendTime.tv_sec - timeNow.tv_sec;
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        int64_t uSecondsToGo = secsDiff * 1000000
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        + (fNextSendTime.tv_usec - timeNow.tv_usec);
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (uSecondsToGo &lt; 0 || secsDiff &lt; 0) {
        </span>
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // sanity check: Make sure that the time-to-delay is non-negative:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        uSecondsToGo = 0;
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="comment" style="color:#0820; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         // Delay this amount of time:
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        nextTask() = envir().taskScheduler().scheduleDelayedTask(uSecondsToGo,
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        (TaskFunc*) sendNext,
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         this
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         );
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
     可以看到为了延迟包的发送，使用了delay task来执行下次打包发送任务。
    </span>
    <br style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px"/>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     sendNext()中又调用了buildAndSendPacket()函数，呵呵，又是一个圈圈。
    </p>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     总结一下调用过程：
    </p>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     <img alt="" src="https://img-blog.csdn.net/20130920171528156?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"/>
     <br/>
    </p>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     最后，再说明一下包缓冲区的使用：
    </p>
    <p style="color:rgb(51,51,51); line-height:26px; font-family:Arial; font-size:14px">
     MultiFramedRTPSink中的帧数据和包缓冲区共用一个，只是用一些额外的变量指明缓冲区中属于包的部分以及属于帧数据的部分（包以外的数据叫做overflow data）。它有时会把overflow data以mem move的方式移到包开始的位置，有时把包的开始位置直接设置到overflow data开始的地方。那么这个缓冲的大小是怎样确定的呢？是跟据调用者指定的的一个最大的包的大小+60000算出的。这个地方把我搞胡涂了：如果一次从source获取一个帧的话，那这个缓冲应设为不小于最大的一个帧的大小才是，为何是按包的大小设置呢？可以看到，当缓冲不够时只是提示一下：
    </p>
    <div class="dp-highlighter bg_cpp" style="margin:18px 0px!important; width:687.04px; color:rgb(51,51,51); line-height:26px; overflow:auto; padding-top:1px; font-family:Consolas,'Courier New',Courier,mono,serif; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; color:silver; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:9px; border-left-color:rgb(108,226,108); border-left-width:3px; border-left-style:solid; background-color:rgb(248,248,248)">
       <strong>
        [cpp]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="view plain">
        view
 plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/niu_gao/article/details/6921145#" rel="nofollow" style="margin:0px 10px 0px 0px; padding:1px; border:currentColor; width:16px; height:16px; color:rgb(160,160,160); text-indent:-2000px; font-size:9px; text-decoration:none; display:inline-block; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="left:531px; top:7460px; width:18px; height:18px; position:absolute; z-index:99">
       </div>
      </div>
     </div>
     <ol class="dp-cpp" start="1" style="margin:0px 0px 1px 45px!important; padding:0px; border:currentColor; color:rgb(92,92,92); background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         if
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         (numTruncatedBytes &gt; 0) {
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        unsigned
        <span class="keyword" style="color:#06699; margin:0px; padding:0px; border:currentColor; font-weight:bold; background-color:inherit">
         const
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         bufferSize = fOutBuf-&gt;totalBytesAvailable();
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        envir()
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         "MultiFramedRTPSink::afterGettingFrame1(): The input frame data was too large for our buffer size ("
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; bufferSize
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ").  "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; numTruncatedBytes
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         " bytes of trailing data was dropped!  Correct this by increasing \"OutPacketBuffer::maxSize\" to at least "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; OutPacketBuffer::maxSize + numTruncatedBytes
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ", *before* creating this 'RTPSink'.  (Current value is "
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
        </span>
       </span>
      </li>
      <li class="alt" style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        &lt;&lt; OutPacketBuffer::maxSize &lt;&lt;
        <span class="string" style="color:blue; margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ".)\n"
        </span>
        <span style="margin:0px; padding:0px; border:currentColor; background-color:inherit">
         ;
        </span>
       </span>
      </li>
      <li style="border-style:none none none solid; list-style:decimal-leading-zero; margin:0px!important; padding:0px 3px 0px 10px!important; line-height:18px; border-left-color:rgb(108,226,108); border-left-width:3px; background-color:rgb(248,248,248)">
       <span style="color:black; margin:0px; padding:0px; border:currentColor; background-color:inherit">
        }
       </span>
      </li>
     </ol>
    </div>
    <p>
     <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
      当然此时不会出错，但有可能导致时间戳计算不准，或增加时间戳计算与source端处理的复杂性(因为一次取一帧时间戳是很好计算的)。
     </span>
    </p>
    <p>
     <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
      原文地址：
      <a href="http://blog.csdn.net/niu_gao/article/details/6921145" rel="nofollow" target="_blank">
       http://blog.csdn.net/niu_gao/article/details/6921145
      </a>
     </span>
    </p>
    <p>
     <span style="font-family:Arial; font-size:14px; color:#333333; line-height:26px">
      live555源代码（VC6）：
     </span>
     <a href="http://download.csdn.net/detail/leixiaohua1020/6374387" rel="nofollow" style="color:rgb(51,102,153); line-height:26px; font-family:Arial; font-size:14px; text-decoration:none" target="_blank">
      http://download.csdn.net/detail/leixiaohua1020/6374387
     </a>
     <br/>
    </p>
   </div>
  </div>
  <div style="display:none;" class="hide-article-box text-center csdn-tracking-statistics tracking-click" data-mod="popu_376">
   <a class="btn btn-red-hollow" id="btn-readmore">
    阅读更多
   </a>
  </div>
 </article>
 <div class="article-bar-bottom">
  <div class="tags-box artic-tag-box">
   <span class="label">
    文章标签：
   </span>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=live555&amp;t=blog" target="_blank">
    live555
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=rtp&amp;t=blog" target="_blank">
    rtp
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=源代码&amp;t=blog" target="_blank">
    源代码
   </a>
  </div>
  <div class="tags-box">
   <span class="label">
    个人分类：
   </span>
   <a class="tag-link" href="https://blog.csdn.net/leixiaohua1020/article/category/1362936" target="_blank">
    Live555
   </a>
  </div>
  <div class="tags-box">
   <span class="label">
    所属专栏：
   </span>
   <a class="tag-link" href="https://blog.csdn.net/column/details/osmedia.html" target="_blank">
    开源多媒体项目源代码分析
   </a>
  </div>
 </div>
 <!-- !empty($pre_next_article[0]) -->
</div>
<div class="recommend-box">
                            <div style="background: #fff; border: dashed 1px #666; padding-left: 1em; padding-top: 1em; padding-bottom: 1em;">
                                <span style="font-size: 0.8em; font-weight: bold;">
                                    此PDF由<a style="color:#0000ff" href="http://www.github.com/spygg"  target="_blank">spygg</a>生成,请尊重原作者版权!!!
                                    <br/>
                                    我的邮箱:liushidc@163.com
                                </span>
                                </div> 
                        </div>
                    </main>
      
                </div>

            <script>
                var recommendCount = 0;
                var articleTit = "";
                var articleId = "";
                var commentscount = 0;

                //1禁止评论，2正常
                var commentAuth = 1;
                //百度搜索
                var baiduKey = "";
                var needInsertBaidu = "";
            </script>
            <script src="https://csdnimg.cn/release/phoenix/template/js/detail-effe72036e.min.js"></script>
            </body>
        </html>