
            <!DOCTYPE html>
            <html lang="zh-CN">
                <head>
                    <meta charset="UTF-8">
                    <title>
 libRTMP使用说明 - CSDN博客
</title>

                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-60a2c245da.min.css">
                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-88717cedf2.min.css">

                <script type="text/javascript">
                var username = "";
                </script>

                <script src="https://csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script>

                <!-- 新版上报 -->
                <!-- 新版上报end -->
                <link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.3/css/sandalstrap.min.css"> 
                </head>
                <body>    
        
                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
                    <div class="container clearfix pt0" id="mainBox">
        <main style="width: 100%;"><div class="blog-content-box">
 <div class="article-title-box" id="article_anchors_267">
  <span class="article-type type-4 float-left">
   译
  </span>
  <h1 class="title-article">
   libRTMP使用说明
  </h1>
 </div>
 <div class="article-info-box">
  <div class="article-bar-top d-flex">
   <span class="time">
    2013年11月07日 00:25:48
   </span>
   <div ">
    <span class="read-count">
     阅读数：44290
    </span>
   </div>
  </div>
 </div>
 <article>
  <div class="article_content clearfix csdn-tracking-statistics" data-dsm="post" data-mod="popu_307" data-pid="blog" id="article_content">
   <link href="https://csdnimg.cn/release/phoenix/template/css/htmledit_views-0a60691e80.css" rel="stylesheet"/>
   <div class="htmledit_views">
    <p align="left">
     <strong>
      名称
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      librtmp − RTMPDump Real-Time Messaging Protocol API
     </p>
    </blockquote>
    <p align="left">
     <strong>
      库
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      RTMPDump RTMP(librtmp, -lrtmp)
     </p>
    </blockquote>
    <p align="left">
     <strong>
      简介
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      #include&lt;librtmp/rtmp.h&gt;
     </p>
    </blockquote>
    <p align="left">
     <strong>
      描述
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      实时流协议（Real-TimeMessaging Protocol，RTMP）是用于互联网上传输视音频数据的网络协议。本API提供了支持RTMP， RTMPT,RTMPE, RTMP RTMPS以及以上几种协议的变种(RTMPTE, RTMPTS)协议所需的大部分客户端功能以及少量的服务器功能。尽管Adobe公司已经公布了RTMP协议规范（RTMP specification），但是本工程并不是通过Adobe的协议规范而是通过逆向工程的方式完成的。因此，它的运行方式可能和公布的协议规范有所偏离，但是一般情况下它和Adobe的客户端的运行方式是一模一样的。
     </p>
     <p align="left">
      RTMPDump 软件包含一个基本的客户端：
      <a href="http://rtmpdump.mplayerhq.hu/man1/rtmpdump.1">
       <strong>
        <span style="color:#0000FF;">
         rtmpdump
        </span>
       </strong>
      </a>
      ,一些示例服务器和一个用来提供对RTMP协议进行支持的库（libRTMP）。本页面对libRTMP的函数进行一个概述。 这些函数可以在 -lrtmp
 库中找到。其他还有很多函数,但是还没有为这些函数写文档。
     </p>
     <p align="left">
      基本的操作如下文所述。
     </p>
     <p align="left">
      <strong>
       RTMP_Alloc
      </strong>
      () ：用于创建一个RTMP会话的句柄。
     </p>
     <p align="left">
      <strong>
       RTMP_Init
      </strong>
      ()：初始化句柄。
     </p>
     <p align="left">
      <strong>
       RTMP_SetupURL
      </strong>
      ()：设置会话的参数。
     </p>
     <p align="left">
      <strong>
       RTMP_Connect
      </strong>
      ()：建立RTMP链接中的网络连接（NetConnection）。
     </p>
     <p align="left">
      <strong>
       RTMP_ConnectStream
      </strong>
      ()：建立RTMP链接中的网络流（NetStream）。
     </p>
     <p align="left">
      <strong>
       RTMP_Read
      </strong>
      ()：读取RTMP流的内容。
     </p>
     <p align="left">
      客户端可以在调用
      <strong>
       RTMP_Connect
      </strong>
      ()之前调用
      <strong>
       RTMP_EnableWrite
      </strong>
      ()，然后在会话开始之后调用
      <strong>
       RTMP_Write
      </strong>
      ()。
     </p>
     <p align="left">
      <strong>
       RTMP_Pause
      </strong>
      ()：流播放的时候可以用于暂停和继续
     </p>
     <p align="left">
      <strong>
       RTMP_Seek
      </strong>
      ()：改变流播放的位置
     </p>
     <p align="left">
      当
      <strong>
       RTMP_Read
      </strong>
      ()返回0 字节的时候,代表流已经读取完毕，而后可以调用
      <strong>
       RTMP_Close
      </strong>
      ()
     </p>
     <p align="left">
      <strong>
       RTMP_Free
      </strong>
      ()：用于清理会话。
     </p>
     <p align="left">
      所有的数据都使用 FLV 格式进行传输。一个基本的会话需要一个RTMP URL。RTMP URL 格式如下所示：
     </p>
     <p align="left">
      <span style="color:#990000;">
       rtmp[t][e|s]://hostname[:port][/app[/playpath]]
      </span>
     </p>
     <p align="left">
      支持普通的，隧道的，以及加密的会话。
     </p>
     <p align="left">
      其他附加的选项可以在URL的后面添加以空格为间隔符的“key=value”形式的字符串。
     </p>
    </blockquote>
    <p align="left">
     <strong>
      选项
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      <strong>
       网络（Network）参数
      </strong>
     </p>
     <p align="left">
      这些选项定义了如何连接一个流媒体服务器。
     </p>
     <p align="left">
      <strong>
       socks=
      </strong>
      <em>
       host:port
      </em>
     </p>
     <p align="left">
      <span style="color:#333333;background-color:#FFFFFF;">
       使用指定
      </span>
      <span style="color:#333333;background-color:#FFFFFF;">
       SOCKS4
      </span>
      <span style="color:#333333;background-color:#FFFFFF;">
       代理。
      </span>
     </p>
     <p align="left">
      <strong>
       连接（Connection）参数
      </strong>
     </p>
     <p align="left">
      这些选项定义了RTMP连接（Connect）请求消息的内容。如果没有提供正确的值，流媒体服务器会拒绝连接请求。
     </p>
     <p align="left">
      <strong>
       app=
      </strong>
      <em>
       name
      </em>
     </p>
     <p align="left">
      连接到RTMP的应用名，覆盖RTMP URL中的app。有时rtmpdumpURL 无法正确自动解析app名称。这时必须使用该选项。
     </p>
     <p align="left">
      <strong>
       tcUrl=
      </strong>
      <em>
       url
      </em>
     </p>
     <p align="left">
      目标流的URL。默认是 rtmp[t][e|s]://host[:port]/app.
     </p>
     <p align="left">
      <strong>
       pageUrl=
      </strong>
      <em>
       url
      </em>
     </p>
     <p align="left">
      流媒体所在的网页的URL。默认情况下没有被发送的价值。
     </p>
     <p align="left">
      <strong>
       swfUrl=
      </strong>
      <em>
       url
      </em>
     </p>
     <p align="left">
      流媒体使用的SWF播放器的的URL。默认情况下没有被发送的价值。
     </p>
     <p align="left">
      <strong>
       flashVer=
      </strong>
      <em>
       version
      </em>
     </p>
     <p align="left">
      swf播放器使用的Flash版本. 默认是"LNX 10,0,32,18"。
     </p>
     <p align="left">
      <strong>
       conn=
      </strong>
      <em>
       type:data
      </em>
     </p>
     <p align="left">
      任意AMF数据追加到connect，类型说明，
     </p>
     <p align="left">
      B 布尔型
     </p>
     <p align="left">
      N 数字
     </p>
     <p align="left">
      S 字符串
     </p>
     <p align="left">
      O 对象
     </p>
     <p align="left">
      Z 空
     </p>
     <p align="left">
      对于布尔型必须是0或1作为FALSE或TRUE，
     </p>
     <p align="left">
      对于对象数据必须以0或1分别作为结束和开始的标制，子对象中数据项前加前缀类型N，并指定值名称，例如：
     </p>
     <p align="left">
      -C B:1 -C S:authMe -C O:1 -C NN:code:1.23-C NS:flag:ok -C O:0
     </p>
     <p align="left">
      <strong>
       会话（Session）参数
      </strong>
     </p>
     <p align="left">
      这些选项在连接成功后生效。
     </p>
     <p align="left">
      <strong>
       playpath=
      </strong>
      <em>
       path
      </em>
     </p>
     <p align="left">
      覆盖RTMP URL解析的playpath，rtmpdump有时不能正确解析，通过该选项明确。
     </p>
     <p align="left">
      <strong>
       playlist=
      </strong>
      <em>
       0|1
      </em>
     </p>
     <p align="left">
      在play命令之前发生set_playlist命令。否则播放列表将会值包含playpath。
     </p>
     <p align="left">
      <strong>
       live=
      </strong>
      <em>
       0|1
      </em>
     </p>
     <p align="left">
      指定媒体是实时流。在实时流中没有恢复和搜索。
     </p>
     <p align="left">
      <strong>
       subscribe=
      </strong>
      <em>
       path
      </em>
     </p>
     <p align="left">
      订阅的实时流名称。默认playpath。
     </p>
     <p align="left">
      <strong>
       start=
      </strong>
      <em>
       num
      </em>
     </p>
     <p align="left">
      开始到流的秒数（num），实时流无效。
     </p>
     <p align="left">
      <strong>
       stop=
      </strong>
      <em>
       num
      </em>
     </p>
     <p align="left">
      停止到流的秒数（num）。
     </p>
     <p align="left">
      <strong>
       buffer=
      </strong>
      <em>
       num
      </em>
     </p>
     <p align="left">
      设置缓冲时间，单位毫秒。 默认值36000000。
     </p>
     <p align="left">
      <strong>
       timeout=
      </strong>
      <em>
       num
      </em>
     </p>
     <p align="left">
      num秒后没有收到任何数据会话超时，默认值120。
     </p>
     <p align="left">
      <strong>
       安全（Security）参数
      </strong>
     </p>
     <p align="left">
      这些选项处理额外的身份验证，来自服务器的请求。
     </p>
     <p align="left">
      <strong>
       token=
      </strong>
      <em>
       key
      </em>
     </p>
     <p align="left">
      输入安全令牌响应，如果服务器需要使用安全令牌验证。
     </p>
     <p align="left">
      <strong>
       jtv=
      </strong>
      <em>
       JSON
      </em>
     </p>
     <p align="left">
      JSON令牌用于传统Justin.tv服务器 ，调用NetStream.Authenticate.UsherToken。
     </p>
     <p align="left">
      <strong>
       swfVfy=
      </strong>
      <em>
       0|1
      </em>
     </p>
     <p align="left">
      swf播放器的URL，此选项将替换所以三个--swfUrl,--swfhash, and --swfsize选项。使用此选项时，swf播放器将从指定URL检索，并自动计算哈希和大小。此外信息缓存在一个swfinfo文件在用户主目录，所以它在每次rtmpdump运行时，并不需要检索和重新计算。swfinfo记录URL，生成时间，修改SWF文件时间，它的大小，它的哈希，默认情况下，缓冲信息用于30天，然后重新检测。
     </p>
     <p align="left">
      <strong>
       swfAge=
      </strong>
      <em>
       days
      </em>
     </p>
     <p align="left">
      指定使用缓存的swf信息天数，然后重新检查，使用0为经常检查，如果检查显示swf具有相同的修改时间戳，它不会被再次检索。
     </p>
    </blockquote>
    <p align="left">
     <strong>
      例子
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      <strong>
       RTMP_SetupURL
      </strong>
      ()使用的一个例子字符串：
     </p>
     <p align="left">
      "rtmp://flashserver:1935/ondemand/thefile swfUrl=
      <a href="http://flashserver/player.swf">
       <span style="color:#0000FF;">
        http://flashserver/player.swf
       </span>
      </a>
      swfVfy=1"
     </p>
    </blockquote>
    <p align="left">
     <strong>
      参见
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p align="left">
      <a href="http://rtmpdump.mplayerhq.hu/man1/rtmpdump.1">
       <strong>
        <span style="color:#0000FF;">
         rtmpdump
        </span>
       </strong>
      </a>
      (1),
      <a href="http://rtmpdump.mplayerhq.hu/man8/rtmpgw.8">
       <strong>
        <span style="color:#0000FF;">
         rtmpgw
        </span>
       </strong>
      </a>
      (8)
     </p>
    </blockquote>
    <p align="left">
     <strong>
      作者
     </strong>
    </p>
    <blockquote style="margin:0px 0px 0px 40px;padding:0px;border:;">
     <p>
      Andrej Stepanchuk, Howard Chu,The Flvstreamer Team
     </p>
     <p>
      <span style="color:#0000FF;">
       <a href="http://rtmpdump.mplayerhq.hu/">
        http://rtmpdump.mplayerhq.hu
       </a>
      </span>
     </p>
     <p>
      <br/>
     </p>
    </blockquote>
    <p>
     翻译的有的地方还不是很通顺，以后再改进
    </p>
    <p>
     原文地址：
     <a href="http://rtmpdump.mplayerhq.hu/librtmp.3.html">
      http://rtmpdump.mplayerhq.hu/librtmp.3.html
     </a>
    </p>
    <br/>
   </div>
  </div>
  <div style="display:none;" class="hide-article-box text-center csdn-tracking-statistics tracking-click" data-mod="popu_376">
   <a class="btn btn-red-hollow" id="btn-readmore">
    阅读更多
   </a>
  </div>
 </article>
 <div class="article-bar-bottom">
  <div class="tags-box artic-tag-box">
   <span class="label">
    文章标签：
   </span>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=librtmp&amp;t=blog" target="_blank">
    librtmp
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=rtmpdump&amp;t=blog" target="_blank">
    rtmpdump
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=使用说明&amp;t=blog" target="_blank">
    使用说明
   </a>
  </div>
  <div class="tags-box">
   <span class="label">
    个人分类：
   </span>
   <a class="tag-link" href="https://blog.csdn.net/leixiaohua1020/article/category/1362941" target="_blank">
    libRTMP
   </a>
  </div>
 </div>
 <!-- !empty($pre_next_article[0]) -->
</div>
<div class="recommend-box">
                            <div style="background: #fff; border: dashed 1px #666; padding-left: 1em; padding-top: 1em; padding-bottom: 1em;">
                                <span style="font-size: 0.8em; font-weight: bold;">
                                    此PDF由<a style="color:#0000ff" href="http://www.github.com/spygg"  target="_blank">spygg</a>生成,请尊重原作者版权!!!
                                    <br/>
                                    我的邮箱:liushidc@163.com
                                </span>
                                </div> 
                        </div>
                    </main>
      
                </div>

            <script>
                var recommendCount = 0;
                var articleTit = "";
                var articleId = "";
                var commentscount = 0;

                //1禁止评论，2正常
                var commentAuth = 1;
                //百度搜索
                var baiduKey = "";
                var needInsertBaidu = "";
            </script>
            <script src="https://csdnimg.cn/release/phoenix/template/js/detail-effe72036e.min.js"></script>
            </body>
        </html>