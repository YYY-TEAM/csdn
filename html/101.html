
            <!DOCTYPE html>
            <html lang="zh-CN">
                <head>
                    <meta charset="UTF-8">
                    <title>
 最简单的视频网站（JavaEE+FFmpeg） - CSDN博客
</title>

                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-60a2c245da.min.css">
                <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-88717cedf2.min.css">

                <script type="text/javascript">
                var username = "";
                </script>

                <script src="https://csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js" type="text/javascript"></script>

                <!-- 新版上报 -->
                <!-- 新版上报end -->
                <link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.3/css/sandalstrap.min.css"> 
                </head>
                <body>    
        
                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
                    <div class="container clearfix pt0" id="mainBox">
        <main style="width: 100%;"><div class="blog-content-box">
 <div class="article-title-box" id="article_anchors_101">
  <h1 class="title-article">
   最简单的视频网站（JavaEE+FFmpeg）
  </h1>
 </div>
 <div class="article-info-box">
  <div class="article-bar-top d-flex">
   <span class="time">
    2015年02月23日 00:39:24
   </span>
   <div ">
    <span class="read-count">
     阅读数：30451
    </span>
   </div>
  </div>
 </div>
 <article>
  <div class="article_content clearfix csdn-tracking-statistics" data-dsm="post" data-mod="popu_307" data-pid="blog" id="article_content">
   <link href="https://csdnimg.cn/release/phoenix/template/css/htmledit_views-0a60691e80.css" rel="stylesheet"/>
   <div class="htmledit_views">
    <span style="white-space:pre;">
    </span>
    本文记录一个最简单的视频网站系统。此前做过一些基于JavaEE中的SSH (Strut2 + Spring + Hibernate)的网站系统，但是一直没有做过一个视频网站系统，所以就打算做一个“精简”的视频网站系统，以方便以后测试以及学习使用。本视频网站支持直播（通过RTMP实现）和点播（通过HTTP实现）。为了保持精简，这个视频网站系统仅制作了网络视频的管理功能（增删改查），以及相关的参数配置功能。由于自己在JavaEE方面没有深入学习过，所以这个系统有部分功能还没搞完，以后有时间再慢慢完善。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218000523335"/>
    </div>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-family:'FangSong_GB2312';">
      PS：源代码以及在线演示在文章的末尾
     </span>
    </p>
    <br/>
    <h2>
     简介
    </h2>
    <br/>
    <h3>
     架构
    </h3>
    <p>
     <span style="white-space:pre;">
     </span>
     系统前台显示采用了Div + CSS+ Javascript技术。其中前台显示用了一些Javascript插件，例如说生成旋转灯笼式效果的CloudCarousel，生成导航菜单的ddsmoothmenu，用于表单验证的jQuery Validation Engine等等。其中视频播放器用了FlowPlayer（包含了RTMP插件）来支持HTTP的点播和RTMP的直播。按理说视频文件上传的时候可以使用Ajax实现，但是考虑工作比较繁琐，所以暂时还是使用直接文件上传的方式。
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     系统的后台使用了JavaEE系统中最传统的三层架构：Action层，Service层以及DAO层。其中Action层使用了Struts2框架，用于处理前台页面传来的请求；DAO层使用了Hibernate框架，用于和数据库的交互。Spring框架则用于将Action层，Service层以及DAO层整合起来。系统的前后台交互主要使用了JSTL标签和EL表达式。此外考虑到国际化方面的要求，采用了Struts2的i18n方式，将所有页面上的文字都抽取坐来保存到单独的文件中，这样就可以实现多种语言的显示。
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     系统开始运行后，会开启两个线程VideoThumbnailThread和VideoTranscoderThread。VideoThumbnailThread用于截取视频的缩略图，VideoTranscoderThread则用于转码上传的视频。这两个线程都是通过调用ffmpeg.exe完成相应的功能。
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     此外，系统中还包含了查看媒体信息的功能。该功能通过调用MediaInfo.dll完成，不再详述。
    </p>
    <span style="white-space:pre;">
    </span>
    整个系统的框架如下图所示，后文中再详细记录每部分的功能。
    <br/>
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218000609495"/>
     <br/>
    </div>
    <br/>
    <p>
     <br/>
    </p>
    <h3>
     效果
    </h3>
    <span style="white-space:pre;">
    </span>
    系统主要包含了以下几个页面：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     <strong>
      主页（index.jsp）
     </strong>
     ：进入系统的第一个页面。
     <br/>
     <strong>
      视频列表（videolist.jsp）
     </strong>
     ：列表显示视频资源的页面。按照视频源的类型的不同可以分为点播（VOD）视频列表和直播（Live）视频列表。
     <br/>
     <strong>
      视频编辑（videoedit.jsp）
     </strong>
     ：编辑视频资源的页面。按照视频源的类型的不同可以分为点播（VOD）编辑和直播（Live）编辑。按照操作的不同可以分为添加（Add）和编辑（Edit）。
     <br/>
     <strong>
      视频内容（videocontent.jsp）
     </strong>
     ：查看视频的内容的页面。按照视频源的类型的不同可以分为点播（VOD）视频内容和直播（Live）视频内容。
     <br/>
     <strong>
      设置（configure.jsp）
     </strong>
     ：设置页面。用于配制系统的参数。
     <br/>
     <strong>
      关于（about.jsp）
     </strong>
     ：显示系统相关的一些信息的页面。
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
    </blockquote>
    <br/>
    <h4>
     首页
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     网站首页的如下图所示。Logo位于左上角，菜单栏位于右上角。为了美观一些，页面上方做了一个灯箱效果的特效，随机显示一些视频的缩略图。页面下方则分别列出“点播列表”和“直播列表”中最近添加的几个视频。
    </p>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218000930130?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <h4>
     点播列表
    </h4>
    <span style="white-space:pre;">
    </span>
    点播列表页面如下图所示。在该页面中，可以对点播视频进行简单的管理：查看内容，添加，修改以及删除。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001021904?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </div>
    <br/>
    <h4>
     直播列表
    </h4>
    <span style="white-space:pre;">
    </span>
    点播列表页面如下图所示。直播列表实质上使用了和点播列表相同的页面。在该页面中，可以对直播视频进行简单的管理：查看内容，添加，修改以及删除。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001027304?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <h4>
     视频内容页面
    </h4>
    <span style="white-space:pre;">
    </span>
    视频内容页面如下所示。该页面中包含了一个FlowPlayer播放器，该播放器用于播放视频内容。
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     点播视频内容页面如下所示。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001111138?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <br/>
    <span style="white-space:pre;">
    </span>
    直播视频内容页面如下所示。尽管表面上看点播和直播页面完全相似，但是实际上点播和直播的机制是不一样的。点播依靠的是HTTP渐进式下载，而直播依靠的是FlowPlayer的RTMP组件。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001130747?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <h4>
     视频添加页面
    </h4>
    <span style="white-space:pre;">
    </span>
    点播视频添加页面如下所示。该页面用于上传一个点播视频。“名称”输入框用于指定视频的名称，“文件”用于指定上传的视频文件，“简介”可以指定针对该视频的一段简介。其中，“名称”和“文件”两个输入框为必填项，否则无法提交该页面的表单。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001149529?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <span style="white-space:pre;">
    </span>
    直播视频添加页面如下所示。从图中可以看出直播和点播的添加页面很类似。它们的不同在于：点播是上传一个视频文件，而直播是指定一个URL（目前该URL只支持RTMP）。和点播类似，“名称”和“URL”两个输入框为必填项，否则无法提交该页面的表单。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001206832?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <h4>
     视频编辑页面
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     点播视频编辑页面如下所示。该页面用于编辑已经完成上传的点播视频的信息。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001230154?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     直播视频编辑页面如下所示。该页面用于编辑直播视频的信息。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001257140?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <br/>
    <h4>
     配置
    </h4>
    <span style="white-space:pre;">
    </span>
    系统的配置页面如下图所示。该页面用于配置系统的各种设置（以转码设置为主）。每次配置完成后重启系统后设置生效。包含以下参数。
    <br/>
    <ul>
     <li>
      视频编码器：转码使用的视频编码器，默认值为“libx264”。
     </li>
     <li>
      视频码率 (bps) ：视频编码的码率（单位为bps），默认值为500000（500kbps）。
     </li>
     <li>
      视频帧率 (fps) ：视频编码的帧率（单位为fps），默认值为25。
     </li>
     <li>
      音频编码器：转码时候使用的音频编码器，默认值为“libmp3lame”。
     </li>
     <li>
      音频采样率 (Hz) ：音频编码的采样率（单位为Hz），默认值为22050（22.05kHz）。
     </li>
     <li>
      音频码率 (bps) ：音频编码的码率（单位为bps），默认值为64000（64kbps）。
     </li>
     <li>
      视频宽 (pixel) ：转码后视频的宽（单位为pixel），默认值为640。
     </li>
     <li>
      视频高 (pixel) ：转码后视频的高（单位为pixel），默认值为360。
     </li>
     <li>
      使用水印：选择转码后的视频是否加水印。如果该选项选择“是”，则会在转码后的视频中添加水印。
     </li>
     <li>
      水印文件路径：水印文件的路径，此处为文件相对于网站根目录的路径，默认为“watermark/svw.png”。
     </li>
     <li>
      水印位置-x坐标 (pixel) ：水印在视频中的位置——x坐标（单位为pixel），默认值为5。
     </li>
     <li>
      水印坐标-y坐标 (pixel) ：水印在视频中的位置——y坐标（单位为pixel），默认值为5。
     </li>
     <li>
      保持宽高比并且填充黑边：选择转码后是否保持宽高比。如果该选项选择“是”，则转码后的视频会保持宽高比，并且当输入和输出视频宽高比不一样的时候，会在输出视频中添加黑边。如果该选项选择“否”，则转码后的视频会拉伸成输出分辨率。
     </li>
     <li>
      输出视频封装格式：输出视频的封装格式，默认为“flv”。
     </li>
     <li>
      视频截图位置 (sec) ：获取视频缩略图的位置（单位为sec），默认为5sec。该默认值的含义是获取视频第5秒处的视频帧作为视频的缩略图。
     </li>
     <li>
      上传视频存放文件夹：用于存放上传的视频文件，默认值为“videoori”。
     </li>
     <li>
      转码视频存放文件夹：用于存放转码的视频文件，默认值为“video”。
     </li>
     <li>
      视频截图存放文件夹：用于存放视频的截图，默认值为“videothumbnail”。
     </li>
    </ul>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001417277?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <h4>
     MediaInfo信息
    </h4>
    <span style="white-space:pre;">
    </span>
    MediaInfo信息位于视频内容页面中，在默认的情况下是不显示的。通过修改网页中代码可以显示视频的MediaInfo信息。
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     转码前文件信息如下图所示，从图中可以看出转码前的文件格式是MPEG-PS，视频编码为MPEG-1，音频编码为MP2。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001440194?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     转码后文件信息如下图所示，从图中可以看出转码前的文件是FLV格式的，视频编码为H.264，音频编码MP3。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001442973?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <br/>
    <h4>
     多国语言
    </h4>
    <span style="white-space:pre;">
    </span>
    本系统支持多国语言。选择右上角菜单的“语言”-&gt;“English”可以将系统切换到英文。英文界面如下图所示。
    <br/>
    <div style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001515468?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </div>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     英文版的视频点播列表如下图所示。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001552331?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     英文版的视频内容页面如下图所示。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001609303?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     英文版的配置界面如下图所示。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150218001634620?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
    </p>
    <p>
     <br/>
    </p>
    <h3>
    </h3>
    <h2>
     网站部分
    </h2>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     下面简单记录一下网站部分的关键源代码。分成三个部分：数据库、前台和后台。
    </p>
    <p>
     <br/>
    </p>
    <h3>
     数据库
    </h3>
    <br/>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     系统包含了4张表：video，videostate，category，configure。下面简单记录每个表的含义。
    </p>
    <h4>
     Video表
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     Video表用于存储视频记录。每一个视频对应Video表中的一条记录。该表中的字段如下表所示。
    </p>
    <p style="text-align:center;">
    </p>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="500">
      <tbody>
       <tr>
        <td valign="top">
         <p align="center">
          名称
         </p>
        </td>
        <td valign="top">
         <p align="center">
          类型
         </p>
        </td>
        <td valign="top">
         <p align="center">
          键
         </p>
        </td>
        <td valign="top">
         <p align="center">
          简介
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          id
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          主键
         </p>
        </td>
        <td valign="top">
         <p>
          标识
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          name
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          名称
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          intro
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          简介
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          edittime
         </p>
        </td>
        <td valign="top">
         <p>
          datetime
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          编辑时间
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          categoryid
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          外键
         </p>
        </td>
        <td valign="top">
         <p>
          所属类别
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          islive
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          是否是直播
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          url
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          处理后视频URL
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          oriurl
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          上传视频URL（点播）
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          thumbnailurl
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          缩略图URL
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          videostateid
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          外键
         </p>
        </td>
        <td valign="top">
         <p>
          状态
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          remark
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          备注
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <br/>
    <p>
    </p>
    <p>
     <em>
      *其中点播视频的URL为视频文件的相对路径。
     </em>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     下面例举Video表中的几项和URL有关数据（受限于篇幅，省略其它字段）。
    </p>
    <p style="text-align:center;">
    </p>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="72%">
      <tbody>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Id
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           name
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           islive
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           url
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Oriurl
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Thumbnailurl
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Avatar
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/1.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/Avatar  Blueray 3D.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/1.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           2
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           建国大业
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/2.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/建国大业.mpg
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/2.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           3
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Sintel
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/3.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/sintel.wmv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/3.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           4
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Warcraft III
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/4.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/Warcraft3_End.avi
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/4.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           5
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           CUC IESchool
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/5.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/cuc_ieschool.mkv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/5.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           6
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           中国合伙人
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/6.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/中国合伙人.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/6.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           7
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           那些年，我们一起追的女孩
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/7.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/那些年，我们一起追的女孩.mp4
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/7.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           8
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           春晚是什么？
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/8.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/春晚是什么？.mov
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/8.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           9
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Forrest Gump IMAX
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/9.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/Forrest  Gump IMAX.mp4
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/9.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           10
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           屌丝男士
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/10.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/屌丝男士.mov
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/10.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           11
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           Titanic
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           0
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           video/11.flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videoori/Titanic.mkv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/11.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           12
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           北广传媒移动电视
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://www.bj-mobiletv.com:8000/live/live1
          </span>
         </p>
        </td>
        <td valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/12.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           13
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           香港电视台
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://live.hkstv.hk.lxdns.com/live/hks
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/13.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           14
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           东莞电视台
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://ftv.sun0769.com/dgrtv1/mp4:b1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/14.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           15
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           看看新闻网
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://live.kksmg.com:80/live/mp4:Stream_1
          </span>
         </p>
        </td>
        <td valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/15.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           16
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           绍兴新闻综合
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://www.scbtv.cn/live/new
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/16.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           17
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           央广购物
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://wx.cnrmall.com/live/flv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/17.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           19
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           亚太卫视
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://58.61.150.198:1935/live/Livestream
          </span>
         </p>
        </td>
        <td valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/19.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           20
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           CCTV中学生
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://ams.studytv.cn/livepkgr/264
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/20.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           22
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           广州综合
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://116.199.115.228/live/gztv_tv
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/22.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           23
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           睛彩广州
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://116.199.115.228/live/cmmb
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/23.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           24
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           深圳娱乐
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://tv.sznews.com:1935/live/live_233_mc43
          </span>
         </p>
        </td>
        <td valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/24.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           25
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           南阳新闻综合
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://61.136.113.35/tslsChannelLive/zyys888/live
          </span>
         </p>
        </td>
        <td valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/25.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           26
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           大庆综合
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://live1.baihuwang.com:1935/live/zh
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/26.jpg
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           27
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           温州新闻综合
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           1
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           rtmp://livetv.dhtv.cn:1935/live/news
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
          </span>
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          <span style="font-size:12px;">
           videothumbnail/27.jpg
          </span>
         </p>
        </td>
       </tr>
      </tbody>
     </table>
     <br/>
    </div>
    <p>
    </p>
    <h4>
     Videostate表
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     Videostate表用于存储视频的状态。该表中字段如下表所示。
    </p>
    <br/>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="500">
      <tbody>
       <tr>
        <td valign="top">
         <p align="center">
          名称
         </p>
        </td>
        <td valign="top">
         <p align="center">
          类型
         </p>
        </td>
        <td valign="top">
         <p align="center">
          键
         </p>
        </td>
        <td valign="top">
         <p align="center">
          简介
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          id
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          主键
         </p>
        </td>
        <td valign="top">
         <p align="left">
          标识
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          name
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          名称
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          order
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          顺序
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          cssstyle
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          CSS样式
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          remark
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          备注
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <br/>
    <span style="white-space:pre;">
    </span>
    目前按照执行的顺序定义了4种状态：等待上传，等待截图，等待转码，完成。其中“CSS样式”用于辅助显示视频的状态。该表的内容如下
    <br/>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="500">
      <tbody>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          id
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          name
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          order
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          cssstyle
         </p>
        </td>
        <td valign="top">
         <p align="center">
          remark
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          1
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          等待上传
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          1
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          background:#CCFFFF
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          2
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          等待截图
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          2
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          background:#00FF99
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          3
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          等待转码
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          3
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          background:#00FF00
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          4
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          完成
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          4
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          background:#FFFFFF
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <br/>
    <h4>
     Category表
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     Category表用于存储视频的分类。该表可以用于确定视频的分类，目前还没有做太多开发。
    </p>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="500">
      <tbody>
       <tr>
        <td valign="top">
         <p align="center">
          名称
         </p>
        </td>
        <td valign="top">
         <p align="center">
          类型
         </p>
        </td>
        <td valign="top">
         <p align="center">
          键
         </p>
        </td>
        <td valign="top">
         <p align="center">
          简介
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          id
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          主键
         </p>
        </td>
        <td valign="top">
         <p align="left">
          标识
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          name
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          名称
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          parentid
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          父类别
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          remark
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          备注
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <br/>
    <strong>
     Configure表
    </strong>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     Configure表用于存储系统配置信息。该表中字段如下表所示。
    </p>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="500">
      <tbody>
       <tr>
        <td valign="top">
         <p align="center">
          名称
         </p>
        </td>
        <td valign="top">
         <p align="center">
          类型
         </p>
        </td>
        <td valign="top">
         <p align="center">
          键
         </p>
        </td>
        <td valign="top">
         <p align="center">
          简介
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          id
         </p>
        </td>
        <td valign="top">
         <p>
          int
         </p>
        </td>
        <td valign="top">
         <p align="center">
          主键
         </p>
        </td>
        <td valign="top">
         <p align="left">
          标识
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          name
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          名称
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          val
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          值
         </p>
        </td>
       </tr>
       <tr>
        <td valign="top">
         <p>
          remark
         </p>
        </td>
        <td valign="top">
         <p>
          varchar
         </p>
        </td>
        <td valign="top">
         <p>
         </p>
        </td>
        <td valign="top">
         <p>
          备注
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     该表的内容如下。
    </p>
    <p>
    </p>
    <div align="center">
     <table border="1" cellpadding="0" cellspacing="0" width="600">
      <tbody>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          Id
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          name
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          val
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p align="center">
          remark
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          1
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_vcodec
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          libx264
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Video encoder
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          2
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_bv
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          500000
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Video bitrate
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          3
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_framerate
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          25
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Video frame rate
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          4
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_acodec
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          libmp3lame
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Audio encoder
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          5
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_ar
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          22050
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Audio sample rate
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          6
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_ba
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          64000
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Audio bitrate
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          7
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_scale_w
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          640
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Video width
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          8
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_scale_h
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          360
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Video height
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          9
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_watermarkuse
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          true
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Use Watermark
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          10
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_watermark_url
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          watermark/svw.png
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Watermark file's URL
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          11
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_watermark_x
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          5
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Watermark's location (x)
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          12
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_watermark_y
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          5
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Watermark's location (y)
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          13
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_keepaspectratio
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          true
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Keep original aspect ratio
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          14
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          transcoder_outfmt
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          flv
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Output file format
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          15
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          thumbnail_ss
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          5
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          When to get thumbnail (from start)
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          16
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          folder_videoori
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          videoori
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Folder to save Upload Video
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          17
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          folder_video
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          video
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Folder to save Transcode Video
         </p>
        </td>
       </tr>
       <tr>
        <td nowrap="nowrap" valign="top">
         <p>
          18
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          folder_thumbnail
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          videothumbnail
         </p>
        </td>
        <td nowrap="nowrap" valign="top">
         <p>
          Folder to save Thumbnail of Video
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <p>
    </p>
    <br/>
    <h3>
     前台
    </h3>
    <br/>
    <span style="white-space:pre;">
    </span>
    前台部分没有太多可以记录的，基本上都是各种DIV和CSS的调整。其中使用了较多的JSTL标签以及EL表达式。此外使用了Struts2标签用于支持国际化。基本的jsp页面只有6个：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     <em>
      index.jsp：首页。
      <br/>
      videolist.jsp：视频列表——直播视频列表，点播视频列表。
      <br/>
      videoedit.jsp：视频编辑——直播视频添加，直播视频编辑，点播视频添加，点播视频编辑。
      <br/>
      videocontent.jsp：视频内容——直播视频内容，点播视频内容。
      <br/>
      configure.jsp：配置页面。
      <br/>
      about.jsp：关于页面。
     </em>
     <br/>
    </blockquote>
    <span style="white-space:pre;">
    </span>
    除了基本页面之外，还有一些辅助页面：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     <em>
      cfooter.jsp：页脚。
      <br/>
      cheader.jsp：标题栏。
      <br/>
      csidebar_recent.jsp：侧边栏（最近添加）。
      <br/>
      error.jsp：错误页面。
     </em>
    </blockquote>
    <br/>
    <h4>
     FlowPlayer播放器
    </h4>
    前台页面中用于视频播放的播放器是FlowPlayer。FlowPlayer播放器安装有3个步骤：
    <br/>
    （1）包含FlowPlayer的Js文件
    <br/>
    <pre class="html">&lt;script type="text/javascript" src="videoplayer/flowplayer-3.2.8.min.js"&gt;&lt;/script&gt;</pre>
    （2）添加一个&lt;a&gt;标记
    <br/>
    <pre class="html">&lt;a href="http://www.mywebsite.com/myVideo.flv"
   style="display:block;width:425px;height:300px;"
   id="player"&gt;
&lt;/a&gt;</pre>
    （3）添加一段Javascript代码，其中要包含FlowPlayer的Swf文件
    <br/>
    <pre class="html">&lt;script language="JavaScript"&gt;
  flowplayer("player", "path/to/the/flowplayer-3.2.18.swf");
&lt;/script&gt;</pre>
    <br/>
    <span style="white-space:pre;">
    </span>
    FlowPlayer通过HTTP播放点播视频文件的源代码如下所示。${video.url}中保存了视频的相对URL。
    <br/>
    <pre class="html">&lt;a id="player" href="${pageContext.request.scheme}://${pageContext.request.serverName}:${pageContext.request.serverPort}${pageContext.request.contextPath}/${video.url}"&gt;
&lt;/a&gt;
&lt;script&gt;
   flowplayer("player", "videoplayer/flowplayer-3.2.8.swf");
&lt;/script&gt;</pre>
    <br/>
    <span style="white-space:pre;">
    </span>
    FlowPlayer通过RTMP播放直播视频文件的示例代码如下所示。${video.url}中保存了视频的URL。播放RTMP的时候用到了FlowPlayer的RTMP Plugin。需要注意的是，RTMP的URL需要拆分开来分别填到不同的位置。在这里通过split(‘/’)函数按照“/”将字符串分离为字符串数组。然后将“protocol://server/app”填至plugins的netConnectionUrl字段，playpath填至clip的url字段。
    <br/>
    <pre class="html">                   &lt;a id="player"&gt;
                   &lt;/a&gt;
             &lt;!-- Parse RTMP URL --&gt;
             &lt;script&gt;
                   str='${video.url}';
                   arr=str.split('/');
                   //rtmp://server/app/playpath
                   protocol=arr[0];
                   server=arr[2];
                   app=arr[3];
                   playpath=arr[4];
            flowplayer("player", "videoplayer/flowplayer-3.2.8.swf",{ 
                     clip: { 
                       //scaling:'orig',
                       url: playpath,
                       provider: 'rtmp',
                       live:'true'
                     },  
                     plugins: {  
                        rtmp: {  
                          url: 'videoplayer/flowplayer.rtmp-3.2.8.swf',  
                          netConnectionUrl: protocol+'//'+server+'/'+ app
                        } 
                    } 
                 });
                 
        &lt;/script&gt;</pre>
    <br/>
    <br/>
    <h3>
     后台
    </h3>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     后台部分采用了JavaEE的SSH (Struts2 + Spring + Hibernate)的三层架构，其中的代码不再详细记录。三层分别为Action层、Service层和DAO层。其中Action层采用了Struts2框架，DAO层采用了Hibernate框架，而Spring则整合了这三个层面。
    </p>
    <h4>
     BaseService/BaseDAO
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     SSH三层架构虽然在解耦合方面做得很好，但是却导致开发起来非常繁琐，严重降低了开发的速度。为了方便起见，本系统中在Service层编写了BaseService用于完成通用的Service操作；在DAO层也编写了BaseDAO用于完成通用的DAO操作。这样除非有特殊需求，一般情况下只要调用BaseService中的方法就可以完成各种基本的操作。BaseService包含的接口如下所示。
    </p>
    <pre class="java">/**
 * 最简单的视频网站
 * Simplest Video Website
 *
 * 雷霄骅 Lei Xiaohua
 *
 * leixiaohua1020@126.com
 * 中国传媒大学/数字电视技术
 * Communication University of China / Digital TV Technology
 * http://blog.csdn.net/leixiaohua1020
 *
 * 本程序是一个最简单的视频网站视频。它支持
 * 1.直播
 * 2.点播
 * This software is the simplest video website.
 * It support:
 * 1. live broadcast
 * 2. VOD
 */
package service;
 
import java.util.List;
 
/**
 * @author 雷霄骅
 * 对Object的Service
 * 包含了一些通用的方法
 */
public interface BaseService {
         /**
          * 保存一个对象
          * @param object 一个对象
          */
          public void save(Object object);
          /**
           * 更新一个对象
           * @param object 一个对象
           */
          public void update(Object object);
          /**
           * 删除一个对象
           * @param object 一个对象
           */
          public void delete(Object object);
          /**
           * 根据ID读取一个指定名称的对象
           * @param targetName 对象的名称
           * @param id 对象的ID
           * @return 一个对象
           */
          public Object ReadByID(String targetName,int id);
          
          @SuppressWarnings("rawtypes")
          /**
           * 获取指定类型的所有对象
           * @param targetName 对象类型名称
           * @return 对象的列表
           */
          public List ReadAll(String targetName);
          
          @SuppressWarnings("rawtypes")
          /**
           * 根据“属性-值”获取多个指定类型的对象
           * @param targetName 对象类型名称
           * @param propertyName 对象中属性的名称
           * @param propertyValue 对象中属性的值
           * @return 对象的列表
           */
          public List ReadByProperty(String targetName,String propertyName,Object propertyValue);
 
          /**
           * 根据“属性-值”获取一个指定类型的对象
           * @param targetName 对象类型名称
           * @param propertyName 对象中属性的名称
           * @param propertyValue 对象中属性的值
           * @return 一个对象
           */
          public Object ReadSingle(String targetName,String propertyName,Object propertyValue);
          
          /**
           * 获取多个指定类型的对象，可以限定获取对象数目的多少，并且根据特定的属性进行排序。
           * @param targetName 对象类型名称
           * @param propertyName 对象中属性的名称，用于排序
           * @param num 结果对象列表的最大数目
           * @param order 排序方式，可以选择“asc”或者“desc”
           * @return 对象的列表
           */
          public List ReadLimitedByOrder(String targetName,String propertyName,int num,String order);
          
          /**
           * 获取指定类型的对象的数量。
           * @param targetName 对象类型名称
           * @return 数量
           */
          public int ReadCount(String targetName);
          /**
           * 根据“属性-值”为条件，获取指定类型的对象的数量。
           * @param targetName 对象类型名称
           * @param propertyName 对象中属性的名称
           * @param propertyValue 对象中属性的值
           * @return 数量
           */
         public int ReadCountByProperty(final String targetName,String propertyName, Object value);
         /**
          * 两个功能：
          * 1.根据“属性-值”获取多个指定类型的对象
          * 2.限定获取对象数目的多少，并且根据特定的属性进行排序。
          * @param targetName 对象类型名称
          * @param readpropertyName 对象中属性的名称，用于获取对象
          * @param readvalue 对象中属性的值
          * @param orderpropertyName 对象中属性的名称，用于排序
          * @param num 结果对象列表的最大数目
          * @param order 排序方式，可以选择“asc”或者“desc”
          * @return
          */
         public List ReadByPropertyAndLimitedByOrder(final String targetName, final String readpropertyName,
                            final Object readvalue,final String orderpropertyName, final int num, final String order);
 
}</pre>
    <br/>
    <h3>
    </h3>
    <h2>
     FFmpeg部分
    </h2>
    <br/>
    <h4>
     截取缩略图线程和转码线程
    </h4>
    <br/>
    <p>
     <span style="white-space:pre;">
     </span>
     系统在启动后会开启两个线程：VideoThumbnailThread和VideoTranscoderThread。其中VideoThumbnailThread线程会不停的检测需要截取缩略图的视频，调用相应的FFmpeg命令截取缩略图；VideoTranscoderThread线程会不停的监测需要转码的视频，调用相应的FFmpeg命令转码视频。何以确定视频是否需要截取缩略图以及是否需要转码？这是通过video表中的videostateid字段来标识的。视频开始上传后，该视频记录会被标记为“等待上传”（第1步）；上传完毕后，该视频记录会被标记为“等待截图”（第2步）；截图完毕后，该视频记录会被标记为“等待转码”（第3步）；转码完毕后，该视频记录会被标记为“完成”（第4步）。VideoThumbnailThread会不停地检查系统中“等待截图”的视频，截图完成后将视频标记为“等待转码”；VideoTranscoderThread会不停地检查系统中“等待转码”的视频，转码完成后将视频标记为“完成”。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://img-blog.csdn.net/20150223002607046?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"/>
     <br/>
    </p>
    <p style="text-align:center;">
     <br/>
    </p>
    <h4>
     FFmpeg和Java的整合
    </h4>
    <p>
     <span style="white-space:pre;">
     </span>
     FFmpeg和Java整合的过程中有以下几个需要注意的地方：
    </p>
    <p>
     <strong>
      （1）路径的处理
     </strong>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     FFmpeg处理视频的时候需要用到绝对路径，所以涉及到绝对路径获取的问题。使用ServletContext的getRealPath("/")方法可以获得当前Web应用根目录的绝对路径。例如在自己的电脑上下述代码可以获得Web应用的据对路径：
    </p>
    <pre class="java">ServletContext servletContext;
System.out.println(servletContext.getRealPath("/"));</pre>
    <span style="white-space:pre;">
    </span>
    执行完后输出为：
    <br/>
    <pre class="plain">D:\MyEclipseWorkspace\.metadata\.me_tcat\webapps\simplest_video_website\</pre>
    <span style="white-space:pre;">
    </span>
    相对路径中的URL中路径的分隔采用“/”（正斜杠，Unix系统使用），而上述代码中路径的分隔采用“\”（反斜杠，Windows系统使用）。如果把相对文件路径和绝对目录路径拼接起来传递给FFmpeg的话，FFmpeg是可以识别的，但是这样一来路径中一会“/”一会“\”会给人一种很别扭的感觉，因此可以使用String的replace()方法将“\”统一替换为“/”，这样就整齐多了。例如下面代码：
    <br/>
    <pre class="java">ServletContext servletContext;
System.out.println(servletContext.getRealPath("/").replace('\\', '/'));</pre>
    <span style="white-space:pre;">
    </span>
    执行完后输出为：
    <br/>
    <pre class="plain">D:/MyEclipseWorkspace/.metadata/.me_tcat/webapps/simplest_video_website/</pre>
    <br/>
    <p>
     <strong>
      （2）FFmpeg命令行的调用
     </strong>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     FFmpeg命令行的的调用可以分成两个步骤：
    </p>
    <p>
     <strong>
      （a）生成符合设置的命令
     </strong>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     这一步骤实际上就是一个简单的字符串拼接的过程。根据配置的参数拼接成相应的转码命令。需要注意的是，在输入和输出的文件路径两边要加上双引号。否则当文件路径中包含空格的时候，会导致路径解析错误。
    </p>
    <p>
     <strong>
      （b）调用命令行
     </strong>
    </p>
    <span style="white-space:pre;">
    </span>
    调用命令行使用Runtime.getRuntime().exec(cmdstr)方法就可以了。其中cmdstr常见的格式有两种：
    <br/>
    <pre class="plain">cmd /c {FFmpeg Command}
cmd /c start {FFmpeg Command}</pre>
    <p>
     <span style="white-space:pre;">
     </span>
     第一种格式是在本窗口中直接执行命令，第二种格式是新打开一个窗口执行命令。第一种方法我在JavaEE环境中测试有问题，而且不弹出窗口不便于调试，所以使用第二种执行方法。
    </p>
    <p>
     <strong>
      （c）等待调用的命令行执行完毕
     </strong>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     Runtime.getRuntime().exec()在调用命令后就直接返回当前线程了。这不符合实际的需求。实际中需要系统完成FFmpeg转码工作后，才能做下一步操作。可以用Process的waitFor()方法阻塞当先线程直至调用程序运行结束。
    </p>
    <p>
     <br/>
    </p>
    <h4>
     截取缩略图命令
    </h4>
    FFmpeg截取缩略图命令如下：
    <br/>
    <pre class="plain">ffmpeg -y -i "ourtime.flv" -ss 5 -s 220x110 -f image2 -vframes 1 "thumbnail.jpg"</pre>
    参数含义如下：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     <em>
      -y：输出文件重名的时候，自动覆盖。
      <br/>
      -i：输入文件路径（可以是相对路径或者绝对路径）。
      <br/>
      -ss：截取缩略图的时间点，这里是5s处。
      <br/>
      -s：输出缩略图的分辨率，这里是220x110。
      <br/>
      -f：输出文件格式，这里的image2代表文件格式为图片。
      <br/>
      -vframes：输出视频帧的个数，这里是1。
      <br/>
      最后一个参数为输出的缩略图文件路径。
     </em>
    </blockquote>
    <br/>
    <h4>
     转码命令
    </h4>
    FFmpeg转码命令如下：
    <br/>
    <pre class="plain">ffmpeg -y -i "ourtime.flv" -vcodec libx264 -b:v 500000 -r 25 -acodec libmp3lame -b:a 64000 -ar 22050 -vf scale=w=640:h=360:force_original_aspect_ratio=decrease,pad=w=640:h=360:x=(ow-iw)/2:y=(oh-ih)/2[aa];movie=svw.png[bb];[aa][bb]overlay=x=5:y=5 "ourtime_convert.flv"</pre>
    参数含义如下：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     <em>
      -y：输出文件重名的时候，自动覆盖。
      <br/>
      -i：输入文件路径（可以是相对路径或者绝对路径）。
      <br/>
      -vcodec：视频编码器，这里是libx264。
      <br/>
      -b:v：视频码率，这里是500000bps。
      <br/>
      -r：视频帧率，这里是25fps。
      <br/>
      -acodec：音频编码器，这里是libmp3lame。
      <br/>
      -b:a：音频码率，这里是64000bps。
      <br/>
      -ar：音频采样率，这里是22050Hz。
      <br/>
      -vf：滤镜，用于图像拉伸以及水印叠加。
      <br/>
      最后一个参数为输出的视频文件路径。
     </em>
    </blockquote>
    <br/>
    <p>
     <strong>
      Filter（滤镜）配置
     </strong>
    </p>
    <p>
     <span style="white-space:pre;">
     </span>
     几句话介绍一下Filter的配置：
    </p>
    <ul>
     <li>
      Filter配置参数使用在FFmpeg的-vf参数之后
     </li>
     <li>
      Filter之间可以使用“,”连接，连接之后前一个Filter的输出作为后一个Filter的输入。几个Filter构成一个FilterChain（滤镜链），每个FilterChain以“;”结尾。几个Filter Chain可以构成一个FilterGraph（滤镜图）。可以在Filter的Pad上添加“标签”用于连接其它Filter，Filter标签的形式为“[xx]”（其中“xx”可以随意写一些字符，只要可以起到标记作用就可以了）。
     </li>
     <li>
      Filter的可以使用多个参数，参数之间使用“:”分割。
     </li>
    </ul>
    <p>
     <span style="white-space:pre;">
     </span>
     下面分别记录几个滤镜的使用方法。
    </p>
    <p>
     <strong>
      【scale滤镜】
     </strong>
    </p>
    <span style="white-space:pre;">
    </span>
    scale滤镜使用libswscale对图像进行拉伸。它的参数含义如下：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     w：输出图像的宽。
     <br/>
     h：输出图像的高。
    </blockquote>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     force_original_aspect_ratio：保持视频宽高比的方法，可以使用如下值：（1）disable——不保持宽高比；（2）decrease——需要的时候降低宽或者高；（3）increase——需要的时候提高宽或者高。
    </blockquote>
    <span style="white-space:pre;">
    </span>
    有关force_original_aspect_ratio可以举个例子：输入视频分辨率是1920x800，设置滤镜为：
    <br/>
    <pre class="plain">scale=w=640:h=360:force_original_aspect_ratio=decrease</pre>
    <span style="white-space:pre;">
    </span>
    输出的视频分辨率为640x266。
    <br/>
    <br/>
    <strong>
     【pad滤镜】
    </strong>
    <br/>
    <span style="white-space:pre;">
    </span>
    pad滤镜用于给拉伸后的图像加“黑边”。经过scale滤镜处理之后，视频的宽一定小于等于640，而视频的高一定小于等于360，此时需要使用pad滤镜填充视频的两边（上下或者是左右），保证输出的视频的分辨率为640x360。
    <br/>
    Pad滤镜有四个基本的参数：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     w：填充后视频的宽度
     <br/>
     h：填充后视频的高度
     <br/>
     x：输入视频的左上角在填充后视频中的x坐标
     <br/>
     y：输入视频的左上角在填充后视频中的y坐标
    </blockquote>
    <span style="white-space:pre;">
    </span>
    一个基本的如法如下所示：
    <br/>
    <pre class="plain">pad=w=640:h=480:x=0:y=40</pre>
    <span style="white-space:pre;">
    </span>
    上述滤镜将视频填充为640x480，同时将输入视频的左上角放在（0，40）的位置上。
    <br/>
    <span style="white-space:pre;">
    </span>
    在给视频加黑边的过程中，需要把输入的视频放在填充后视频的中央，而pad滤镜中输入视频的位置是以左上角来确定的，因此确定输入视频的左上角的坐标是一个比较麻烦的事。对此，pad滤镜提供了以下几个变量。
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     iw：输入视频的宽
     <br/>
     ih：输入视频的高
     <br/>
     ow：输出视频的宽
     <br/>
     oh：输出视频的高
    </blockquote>
    <span style="white-space:pre;">
    </span>
    通过上述几个变量，可以得知如果想把输入视频放在填充后视频的中央，输入视频的x坐标应该为(ow-iw)/2，y坐标应该为(oh-ih)/2。
    <br/>
    <br/>
    <strong>
     【movie滤镜】
    </strong>
    <br/>
    <span style="white-space:pre;">
    </span>
    Movie滤镜属于Source滤镜，它用于读取水印图片文件（一般情况下是一个PNG文件）。有关movie滤镜有一个地方需要特别注意：它在Windows下似乎不支持输入路径为绝对路径。因为Windows下文件的绝对路径通常为“D:\test\......\watermark.png”，即其中开头的盘符后面跟着一个“:”。“:”在Filter中是一个特殊字符，会被解析成参数的分隔符，从而导致输入的绝对路径被解析为2个参数，最后造成错误。这个问题当时我调试了半天仍然没有得到解决。因此，Windows下使用movie滤镜的时候，需要保证水印文件就在当前的工作目录中，才能正常运行。
    <br/>
    <br/>
    <strong>
     【overlay滤镜】
    </strong>
    <br/>
    <span style="white-space:pre;">
    </span>
    Overlay滤镜用于叠加两路输入。具体到本文的系统中就是叠加水印文件到视频文件上。它常用的有两个参数：
    <br/>
    <blockquote style="margin:0 0 0 40px;border:none;padding:0px;">
     x：水印左上角的x坐标
     <br/>
     y：水印左上角的y坐标
    </blockquote>
    <br/>
    <span style="white-space:pre;">
    </span>
    经过上述几个滤镜的处理，最终就可以得到一个分辨率为640x360，保持宽高比（加黑边），叠加过水印的视频。
    <br/>
    <p>
     <br/>
    </p>
    <h3>
    </h3>
    <p>
     <br/>
    </p>
    <h2>
     项目主页
    </h2>
    <p>
     <br/>
    </p>
    <p>
     <strong>
      Simplest Video Website
     </strong>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <strong>
      项目主页
     </strong>
    </p>
    <p>
     开源中国：
     <a href="http://git.oschina.net/leixiaohua1020/simplest_video_website">
      http://git.oschina.net/leixiaohua1020/simplest_video_website
     </a>
     <br/>
    </p>
    <p>
     Github：
     <a href="https://github.com/leixiaohua1020/simplest_video_website">
      https://github.com/leixiaohua1020/simplest_video_website
     </a>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <strong>
      在线演示
     </strong>
    </p>
    <p>
     <a href="http://www.velab.com.cn:8080/svw/">
      http://www.velab.com.cn:8080/svw/
     </a>
     <br/>
    </p>
    <p>
     PS：由于本系统没有做用户验证功能，所以访客可以随意添加删除视频。最近发现视频经常被修改或者删除掉，这样就失去了演示的意义。还请访客们尽量少修改演示系统上的视频......
    </p>
    <p>
     <br/>
    </p>
    <p>
     <strong>
      安装步骤
     </strong>
     <br/>
     1.安装JavaEE环境：
     <br/>
     (1)下载安装JDK
     <br/>
     (2)下载安装Tomcat
     <br/>
     (3)下载安装MySQL
     <br/>
     2.FFmpeg
     <br/>
     (1)下载并且解压缩FFmpeg可执行程序
     <br/>
     (2)把FFmpeg的bin目录(其中包含ffmpeg.exe)添加至系统的"path"环境变量(重要，这样才可以在系统任意目录中使用ffmpeg命令)
     <br/>
     3.复制程序
     <br/>
     (1)修改Webroot\WEB-INF\classes\hibernate.cfg.xml中数据库的用户名和密码
     <br/>
     (2)拷贝WebRoot目录至Tomcat的webapps目录，重新取个名字(例如"svw")
     <br/>
     (3)在MySQL中创建数据库"svw"，在其中执行svw.sql，创建数据库中的表，并且添加测试数据
     <br/>
     4.启动Tomcat
     <br/>
     5.使用浏览器访问http://localhost:8080/svw
     <br/>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
   </div>
  </div>
  <div style="display:none;" class="hide-article-box text-center csdn-tracking-statistics tracking-click" data-mod="popu_376">
   <a class="btn btn-red-hollow" id="btn-readmore">
    阅读更多
   </a>
  </div>
 </article>
 <div class="article-bar-bottom">
  <div class="tags-box artic-tag-box">
   <span class="label">
    文章标签：
   </span>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=视频&amp;t=blog" target="_blank">
    视频
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=网站&amp;t=blog" target="_blank">
    网站
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=FFmpeg&amp;t=blog" target="_blank">
    FFmpeg
   </a>
   <a class="tag-link" href="http://so.csdn.net/so/search/s.do?q=JavaEE&amp;t=blog" target="_blank">
    JavaEE
   </a>
  </div>
  <div class="tags-box">
   <span class="label">
    个人分类：
   </span>
   <a class="tag-link" href="https://blog.csdn.net/leixiaohua1020/article/category/1843731" target="_blank">
    我的开源项目
   </a>
  </div>
  <div class="tags-box">
   <span class="label">
    所属专栏：
   </span>
   <a class="tag-link" href="https://blog.csdn.net/column/details/ffmpeg-devel.html" target="_blank">
    FFmpeg
   </a>
  </div>
 </div>
 <!-- !empty($pre_next_article[0]) -->
</div>
<div class="recommend-box">
                            <div style="background: #fff; border: dashed 1px #666; padding-left: 1em; padding-top: 1em; padding-bottom: 1em;">
                                <span style="font-size: 0.8em; font-weight: bold;">
                                    此PDF由<a style="color:#0000ff" href="http://www.github.com/spygg"  target="_blank">spygg</a>生成,请尊重原作者版权!!!
                                    <br/>
                                    我的邮箱:liushidc@163.com
                                </span>
                                </div> 
                        </div>
                    </main>
      
                </div>

            <script>
                var recommendCount = 0;
                var articleTit = "";
                var articleId = "";
                var commentscount = 0;

                //1禁止评论，2正常
                var commentAuth = 1;
                //百度搜索
                var baiduKey = "";
                var needInsertBaidu = "";
            </script>
            <script src="https://csdnimg.cn/release/phoenix/template/js/detail-effe72036e.min.js"></script>
            </body>
        </html>